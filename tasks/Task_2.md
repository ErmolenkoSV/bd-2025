# Задача 2

Биржа `Binance` предоставляет доступ к архиву торгов. Данные по сырым тиковым трейдам (один трейд - одна строка) расположены по ссылке: https://data.binance.vision/?prefix=data/spot/daily/trades/ 

Название директорий (тикеры) совпадает с валютными парами. Для валютной пары `BTCUSDT`:
Базовый актив: `BTC` 
Котируемая валюта: `USDT` 

Данные хранятся в заархивированном `csv`-файле со следующими полями:
`trade_id, price, quantity, quote_qty, timestamp, is_buyer_maker, is_best_match`

| Поле              | Тип         | Описание                                                                  |
|-------------------|--------------|--------------------------------------------------------------------------|
| `trade_id`        | `int`        | Уникальный идентификатор трейда                                          |
| `price`           | `float`      | Цена сделки                                                              |
| `quantity`        | `float`      | Количество базового актива                                               |
| `quote_qty`       | `float`      | Сумма сделки в котируемой валюте (`price * quantity`  )                  |
| `timestamp`       | `int (us)`   | Время сделки в us (~с 01.01.2025)(UTC) или ms                            |
| `is_buyer_maker`  | `bool`       | `True`, если инициатор сделки — продавец (market ордер от покупателя)    |
| `is_best_match`   | `bool`       |  В архивах обычно только True                                            | 

### Часть 1
1. Написать скрипт (оформить по всем правилам с парсингом аргументов командной строки), который загружает тиковые данные (tick trades) с Binance (нельзя пользоваться сторонними библиотеками, которые ориентированы именно на работу с Binance).
2. Скрипт должен принимать параметр — валютную пару (например, btcusdt, ethusdt и т.д.), число потоков и скачивать данные по заданной валютной паре начиная с 01.01.2025.
3. Данные должны сохраняться в формате `parquet`. 
4. Нужно выбрать 3 любые торговые пары и скачать по ним данные

### Часть 2
Необходимо написать другой скрипт, который используя библиотеку Polars, строит свечи (candlesticks). На входы подается набор данных (один или несколько файлов) из предыдущей части, на выходе - новый файл со свечами с интервалами: 500 мс, 1 секунда, 1 минута (задается как параметр командной строки). Cм [OHLC](https://en.wikipedia.org/wiki/Open-high-low-close_chart) .

То есть нужно агрегировать все трейды, которые попадают в заданный интервал и посчитать dataframe со следующими полями:

| Поле        | Описание                                                                 |
|-------------|--------------------------------------------------------------------------|
| `timestamp` | Метка времени начала интервала                                           |
| `high`      | Максимальная цена среди всех трейдов в интервале                         |
| `low`       | Минимальная цена среди всех трейдов в интервале                          |
| `close`     | Цена последнего трейда в интервале                                       |
| `random`    | Цена случайного трейда в интервале                                       |
| `num_trades`| Общее количество сделок в интервале                                      |
| `volume`    | Суммарный объём сделки в котируемой валюте (например, USDT)              |


 ### Часть 3
 Необходимо написать еще один скрипт, который используя библиотеку Polars, строит дискретизированные трейды. На входы подается набор данных (один или несколько файлов) из первой части, на выходе - новый файл с дискретизированными трейдами по интервалам: 250 мс, 500 мс, 1 секунда, 1 час (задается как параметр командной строки). 

То есть нужно агрегировать все трейды, которые попадают в заданный интервал разделить их по `is_buyer_maker` и посчитать dataframe со следующими полями:

| Поле             | Описание                                                                 |
|------------------|--------------------------------------------------------------------------|
| `timestamp`      | Метка времени начала интервала                                           |
| `price`          | Взвешенная средняя цена сделки                                           |
| `quantity`       | Суммарное количество базового актива в интервале                         |
| `quote_qty`      | Суммарный объём в котируемой валюте (`price * quantity`)                 |
| `num_trades`     | Общее число сделок в интервале                                           |
| `is_buyer_maker` | Тип трейда                                                               |

